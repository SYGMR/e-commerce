"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactAdmin = require("react-admin");

var _react = _interopRequireDefault(require("react"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function guessType(parameter, apiPlatform) {
  let type = guessTypeForApiPlatform(parameter, apiPlatform);
  return type !== undefined ? type : guessTypeFromRange(parameter.range);
}

function guessTypeForApiPlatform(parameter, apiPlatform = true) {
  if (apiPlatform) {
    // List filters are discarded because there is no built-in filter component in react-admin that can handle this case.
    if (parameter.variable.match(/.*\[\]/i)) return null; // Order filters are discaded because it is only used to know if a column should be sortable or not.

    if (parameter.variable.match(/^order\[.+\]$/)) return null;
    if (parameter.variable.match(/.*\[between\]/i) !== null) return 'between';
  }
}

function guessTypeFromRange(range) {
  switch (range) {
    case 'http://www.w3.org/2001/XMLSchema#integer':
    case 'http://www.w3.org/2001/XMLSchema#float':
      return 'number';

    case 'http://www.w3.org/2001/XMLSchema#boolean':
      return 'nullableBoolean';

    case 'http://www.w3.org/2001/XMLSchema#dateTime':
      return 'date';

    default:
      return 'text';
  }
}

var _default = (parameter, options) => {
  let type = guessType(parameter, options.apiPlatform);

  switch (type) {
    case 'date':
      return _react.default.createElement(_reactAdmin.DateInput, _extends({
        key: parameter.variable,
        source: parameter.variable
      }, options));

    case 'nullableBoolean':
      return _react.default.createElement(_reactAdmin.NullableBooleanInput, _extends({
        key: parameter.variable,
        source: parameter.variable
      }, options));
    // TODO : create a dedicated Input

    case 'between':
      return null;

    case 'number':
      return _react.default.createElement(_reactAdmin.NumberInput, _extends({
        key: parameter.variable,
        source: parameter.variable
      }, options));

    case 'text':
      return _react.default.createElement(_reactAdmin.TextInput, _extends({
        key: parameter.variable,
        source: parameter.variable
      }, options));

    default:
  }
};

exports.default = _default;