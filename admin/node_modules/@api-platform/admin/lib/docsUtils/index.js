"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getReferenceNameField = getReferenceNameField;
exports.getFiltersParametersFromResourceSchema = exports.getOrderParametersFromResourceSchema = void 0;

function getReferenceNameField(reference) {
  const field = reference.fields.find(field => 'http://schema.org/name' === field.id);
  return field ? field.name : 'id';
}

const ORDER_MARKER = 'order[';

const getOrderParametersFromResourceSchema = resourceSchema => {
  const authorizedFields = resourceSchema.fields.map(field => field.name);
  return resourceSchema.parameters.map(filter => filter.variable).filter(filter => filter.includes(ORDER_MARKER)).map(orderFilter => orderFilter.replace(ORDER_MARKER, '').replace(']', '')).filter(filter => authorizedFields.includes(filter));
};

exports.getOrderParametersFromResourceSchema = getOrderParametersFromResourceSchema;

const getFiltersParametersFromResourceSchema = resourceSchema => {
  const authorizedFields = resourceSchema.fields.map(field => field.name);
  return resourceSchema.parameters.map(filter => ({
    name: filter.variable,
    isRequired: filter.required
  })).filter(filter => !filter.name.includes(ORDER_MARKER)).filter(filter => authorizedFields.includes(filter.name));
};

exports.getFiltersParametersFromResourceSchema = getFiltersParametersFromResourceSchema;